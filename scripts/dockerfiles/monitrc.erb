set daemon 10

# We use a random account here that's not read-only to allow local access to
# monit via the monit CLI. This is the only mechanism we've found that ensures
# remote access is read-only and accessible using the "knowable" credentials 
# provided by the user. We're afraid of exposing writable access to remote clients
# using a non-TLS enabled connection.
set httpd port <%= p("hcf.monit.port") %> and use address 0.0.0.0
  allow "<%= SecureRandom.hex %>":"<%= SecureRandom.hex %>"
  allow "<%= p("hcf.monit.user") %>":"<%= p("hcf.monit.password") %>" read-only

include /etc/monit/monitrc.d/cron
include /etc/monit/monitrc.d/rsyslog

include /var/vcap/monit/*.monitrc
include /var/vcap/monit/job/*.monitrc

# Pull this out of /etc/monit/monitrc

set eventqueue basedir /var/vcap/sys/run/monit_event_queue slots 100
# What should '192.168.77.77' be changed to?
# set mmonit http://<% p("hcf.monit.user") %>:<% p("hcf.monit.password") %>@192.168.77.77:8080/collector
set mmonit http://192.168.77.77:8080/collector
    and register without credentials     # Don't register credentials

